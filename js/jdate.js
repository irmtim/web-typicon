function jDate(y,m,d,st){this.st=st,this.d2j=function(y,m,d,st){var a=Math.floor((14-m)/12),y=Math.floor(y+4800-a),m=Math.floor(m+12*a-3);return d+Math.floor((153*m+2)/5)+365*y+Math.floor(y/4)+(st?-Math.floor(y/100)+Math.floor(y/400)+38:0)-32083;},this.jdn=this.d2j(y,m,d,this.st),this.day=((this.jdn+1)%7)+1,this.j2gd=function(j){var j=j||this.jdn,a=j+32044,b=Math.floor((4*a+3)/146097),c=a-Math.floor(146097*b/4),d=Math.floor((4*c+3)/1461),e=c-Math.floor(1461*d/4),m=Math.floor((5*e+2)/153),date=e-Math.floor((153*m+2)/5)+1,month=m+3-12*Math.floor(m/10),year=100*b+d-4800+Math.floor(m/10);return{'y':year,'m':month,'d':date}},this.j2jd=function(j){var j=j||this.jdn,c=j+32082,d=Math.floor((4*c+3)/1461),e=c-Math.floor(1461*d/4),m=Math.floor((5*e+2)/153),date=e-Math.floor((153*m+2)/5)+1,month=m+3-12*Math.floor(m/10),year=d-4800+Math.floor(m/10);return{'y':year,'m':month,'d':date}},this.gymd=this.j2gd(),this.jymd=this.j2jd(),this.ymd=this.st?this.gymd:this.jymd,this.countPasha=function(y){function count(y){var a=(19*(y%19)+15)%30,b=(2*(y%4)+4*(y%7)+6*a+6)%7,f=a+b,m=f<=9?3:4,d=f<=9?22+f:f-9;return{'y':y,'m':m,'d':d}}var y=y||this.ymd.y,p,n,t=count(y),t=this.d2j(t.y,t.m,t.d,false);if(this.jdn>=t){var p=t,n=count(+y+1),n=this.d2j(n.y,n.m,n.d,false)}else{var n=t,p=count(+y-1),p=this.d2j(p.y,p.m,p.d,false)}return{'p':p,'n':n};},this.jdnp=this.countPasha(),this.gpp=this.j2gd(this.jdnp.p),this.gnp=this.j2gd(this.jdnp.n),this.jpp=this.j2jd(this.jdnp.p),this.jnp=this.j2jd(this.jdnp.n),this.pp=this.st?this.gpp:this.jpp,this.np=this.st?this.gnp:this.jnp,this.dbp=this.jdnp.n-this.jdn,this.dap=this.jdn-this.jdnp.p+1,this.glas=this.dap<7?this.dap:(this.dap==7?8:(this.dap<51?((this.dap-1)-(this.dap-1)%7)/7:(this.dap<57||this.dbp<9?null:(this.day==1?(((this.dap-50)/7-1)%8==0?8:((this.dap-50)/7-1)%8):(((this.dap-1-(this.dap-1)%7)/7)%8==0?8:((this.dap-1-(this.dap-1)%7)/7)%8))))),this.week=this.dap<8?null:(this.dap<51?(this.glas+1):(this.dap<57||this.dbp==70||this.dbp==63||this.dbp<58?null:(this.day==1?(this.dap-50)/7:1+((this.dap-50)-(this.dap-50)%7)/7))),this.getfday=function(opt){var y=opt&&opt.y!==undefined?opt.y:this.ymd.y,m=opt&&opt.m!==undefined?opt.m:this.ymd.m,st=opt&&opt.st!==undefined?opt.st:this.st;return((this.d2j(y,m,1,st)+1)%7)+1},this.getldate=function(opt){var y=opt&&opt.y!==undefined?opt.y:this.ymd.y,m=opt&&opt.m!==undefined?opt.m:this.ymd.m,st=opt&&opt.st!==undefined?opt.st:this.st;return this.st?this.j2gd(this.d2j(y,+m+1,0,st)).d:this.j2jd(this.d2j(y,+m+1,0,st)).d},this.setdate=function(opt){var y=opt&&opt.y!==undefined?opt.y:this.ymd.y,m=opt&&opt.m!==undefined?opt.m:this.ymd.m,d=opt&&opt.d!==undefined?opt.d:this.ymd.d,st=opt&&opt.st!==undefined?opt.st:this.st;if(st!=this.st)this.st=st;this.jdn=this.d2j(y,m,d,st),this.day=((this.jdn+1)%7)+1,this.gymd=this.j2gd(),this.jymd=this.j2jd();this.ymd=this.st?this.gymd:this.jymd,this.jdnp=this.countPasha(),this.gpp=this.j2gd(this.jdnp.p),this.gnp=this.j2gd(this.jdnp.n),this.jpp=this.j2jd(this.jdnp.p),this.jnp=this.j2jd(this.jdnp.n),this.pp=this.st?this.gpp:this.jpp,this.np=this.st?this.gnp:this.jnp,this.dbp=this.jdnp.n-this.jdn,this.dap=this.jdn-this.jdnp.p+1},this.dbp2jdn=function(d){d=d||d==0?d:this.dbp;return this.j2jd(this.jdnp.n-d)},this.dap2jdn=function(d){d=d||this.dap;return this.j2jd(this.jdnp.p+d-1)},this.key=function(y){var x=this.countPasha(y);x=this.j2jd(this.d2j(y,2,1)<x.p?x.p:x.n);if(x.m<4){x=x.d==22?'А':x.d==23?'Б':x.d==24?'В':x.d==25?'Г':x.d==26?'Д':x.d==27?'Е':x.d==28?'Ж':x.d==29?'S':x.d==30?'З':'И'}else{x=x.d==1?'I':x.d==2?'К':x.d==3?'Л':x.d==4?'М':x.d==5?'Н':x.d==6?'О':x.d==7?'П':x.d==8?'Р':x.d==9?'С':x.d==10?'Т':x.d==11?'У':x.d==12?'Ф':x.d==13?'Х':x.d==14?'Ѿ':x.d==15?'Ц':x.d==16?'Ч':x.d==17?'Ш':x.d==18?'Щ':x.d==19?'Ъ':x.d==20?'Ы':x.d==21?'Ь':x.d==22?'Ѣ':x.d==23?'Ю':x.d==24?'Ѫ':'Ѧ'}x+=this.getldate({'y':y,'m':2})>28?'в':'';return x},this.compare=function(x,a,b){var ay=a&&a.y!==undefined?a.y:this.jymd.y,am=a&&a.m!==undefined?a.m:this.jymd.m,ad=a&&a.d!==undefined?a.d:this.jymd.d,aj=this.d2j(ay,am,ad,false),by=b&&b.y!==undefined?b.y:this.jymd.y,bm=b&&b.m!==undefined?b.m:this.jymd.m,bd=b&&b.d!==undefined?b.d:this.jymd.d,bj=this.d2j(by,bm,bd,false);return x>=aj&&x<=bj?bj-x+1:false}}